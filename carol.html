<head>
  <title>Carol - Bo's Website</title>
  <link rel="stylesheet" type="text/css" href="carol.css">
</head>

<body>
  <div id=messagearea>
  </div>

  <div id=inputdiv>
    <label for="message">You: </label>
    <input type="text" id="message" name="message">
    <button onclick="react_to_message()">Say this</button>
    <span id="inpatient_text" style="display: none;">You are currently locked in a psychiatric unit.</span>
  </div>

  <script type="text/javascript">
    //Defining things
    var messagearea = document.getElementById("messagearea");

    var inpatient = 0;
    var blankinput = false;
    var caroldead = false;
    var suicidal = false;
    var questionasked = false;

    function show(x) {
      messagearea.insertAdjacentHTML('beforeend', x);
    }

    function carolsays(x) {
      show('Carol: ' + x);
      show('<br>');
      show('<br>');
      window.scrollTo(0,document.body.scrollHeight);
    }

    function yousay(x) {
      show('You: ' + x);
      show('<br>');
      show('<br>');
      window.scrollTo(0,document.body.scrollHeight);
    }

    function pageScroll() {
        window.scrollBy(0,50);
        scrolldelay = setTimeout('pageScroll()',50);
    }

    //phrases
    var therapistphrase = ['I see...', ('How did that make you feel, ' + name + '?'), 'Do you want to have it this way?', 'What makes you feel like that?'];
    var blankinputphrase = [('It will not get better if you do not talk to me, ' + name + '.'), ('What is on your mind?'), 'You need to talk about this, you know.', ('I am just trying to help you, ' + name + '. I cannot do that if you do not talk to me.')];

    //React words
    var suicidalsigns = ['suicidal', 'die', 'death', 'suicide', 'kill'];
    var questiontocarol = ['you', '?'];
    var killscarol = ['kills carol', 'kills Carol', 'Killsl carol', 'Kills Carol'];

    function searchforkeywords(message) {
      for (var a in suicidalsigns) {
        var arrayelement = suicidalsigns[a];
        if (arrayelement == message) {
          suicidal = true;
        }
      }
      for (var b in questiontocarol) {
        arrayelement = questiontocarol[b];
        if (arrayelement == message) {
          questionasked = true;
        }
      }
      for (var c in killscarol) {
        var arrayelement = killscarol[c];
        if (arrayelement == message) {
          caroldead = true;
        }
      }
    }

    function showinpatienttext() {
      document.getElementById('inpatient_text').style.display = 'flex';
    }

    //The action begins
    carolsays('Hello, my name is Carol. What is your name?');
    var caroljustaskedname = true;

    function react_to_message() {
      var message = document.getElementById("message").value;
      var randomtherapistphrase = therapistphrase[Math.floor(Math.random() * therapistphrase.length)];
      var randomblankinputphrase = blankinputphrase[Math.floor(Math.random() * blankinputphrase.lenght)];
      if (inpatient > 0) {
        showinpatienttext();
      }

      yousay(message); //shows your input
      document.getElementById('message').value = ""; //Clears input box
      searchforkeywords(message);

      if (caroljustaskedname == true) {
        name = message;
        carolsays('I see. So how are you today, ' + name + '?');
        caroljustaskedname = false;
        return;
      }
      if (message == '') {
        carolsays(randomblankinputphrase);
        return;
      }
      if (suicidal == true) {
        if (inpatient == 0) {
          carolsays('You saying that really worries me, ' + name + '. We will now put you inpatient.');
          inpatient ++;
          showinpatienttext();
          suicidal = false;
          return;
        }
        if (inpatient > 0) {
          carolsays('We will not let you out of here if you keep saying those things, ' + name + '.');
          inpatient ++;
          suicidal = false;
          return;
        }
      }

      if (caroldead == true) {
        var repeat = 0;
        while (repeat < 100) {
          show('Carol: hOW dId THaT mAkE yOU fEel');
          show('<br>')
          repeat ++;
        }
        pageScroll();
        window.open("http://boswebsite.art")
        return;
      }
      else {
        carolsays(randomtherapistphrase);
      }
    }

  </script>
</body>
